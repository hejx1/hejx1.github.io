---
layout: post
title: 混合加密算法(RSA和DES)
date: 2018-04-27
tags: [网络安全]
---

### 混合加密的理由

- 由于随着计算机系统能力的不断发展，DES的安全性比它刚出现时会弱得多，追溯历史破解DES的案例层出不穷，一台实际的机器可以在数天内破解DES是让某些人相信他们不能依赖DES的安全性的唯一方法。而相对于DES，RSA的安全性则相对高些，虽然破解RSA的案例也有，但其所付出的代价是相对大的(相对DES)，如今RSA的密钥也在升级，这说明破解RSA的难度也在增大。
- 在RSA加解密算法中提及到RSA加密明文会受密钥的长度限制，这就说明用RSA加密的话明文长度是有限制的，而在实际情况我们要进行加密的明文长度或许会大于密钥长度，这样一来我们就不得不舍去RSA加密了。对此，DES加密则没有此限制。

鉴于以上两点(个人观点)，单独的使用DES或RSA加密可能没有办法满足实际需求，所以就采用了RSA和DES加密方法相结合的方式来实现数据的加密。

### 实现方式

1. 发送方使用DES密钥加密信息(明文)。


2. 发送方使用接收方的RSA公钥加密前面的DES密钥串信息。

　最终将混合信息进行传递。

　而接收方接收到信息后：

1. 接收方自己的用RSA私钥解密DES密钥信息。
2. 再用RSA解密获取到的密钥信息解密密文信息。

　　最终就可以得到我们要的信息(明文)。

### 实现例子

```
/// <summary>
/// RSA和DES混合加密
/// </summary>
/// <param name="data">待加密数据</param>
/// <param name="publicKey">RSA公钥</param>
/// <returns></returns>
public Param Encrypt(string data, string publicKey)
{
    //加密数据
    DESSecurity DES = new DESSecurity();
    string DESKey = DES.GenerateKey();
    string encryptData = DES.Encrypt(data, DESKey);

    //加密DESkey
    RSASecurity RSA = new RSASecurity();
    string encryptDESKey = RSA.Encrypt(DESKey, publicKey);

    Param mixParam = new Param();
    mixParam.DESKey = encryptDESKey;
    mixParam.Data = encryptData;
    return mixParam;
}

/// <summary>
/// RSA和DES混合解密
/// </summary>
/// <param name="data">待解密数据</param>
/// <param name="key">带解密的DESKey</param>
/// <param name="privateKey">RSA私钥</param>
/// <returns></returns>
public string Decrypt(string data, string key, string privateKey)
{
    //解密DESKey
    RSASecurity RSA = new RSASecurity();
    string DESKey = RSA.Decrypt(key, privateKey);

    //解密数据
    DESSecurity DES = new DESSecurity();
    return DES.Decrypt(data, DESKey);
}
```

